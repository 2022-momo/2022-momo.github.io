---
title: "Spring Profileì„ í†µí•œ ì‹¤í–‰ í™˜ê²½ ë¶„ë¦¬"
date: 2022-08-21
tags: ["SpringFramework", "Profile"]
draft: false
---

> í•´ë‹¹ í¬ìŠ¤íŠ¸ëŠ” ëª¨ëª¨íŒ€ í¬ë£¨ [ë ‰ìŠ¤](https://github.com/Seongwon97)ê°€ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

# í•™ìŠµ ê³„ê¸°
í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ë°°í¬ë¥¼ ì§„í–‰í•˜ë‹¤ë³´ë‹ˆ ê°œë°œì„œë²„, ë°°í¬ì„œë²„ê°€ ìƒê²¨ë‚¬ë‹¤. ê·¸ ê²°ê³¼ ê°ê°ì˜ ì„œë²„ ë³„ë¡œ ì—°ê²°ë˜ëŠ” DBê°€ ë‹¤ë¥¸ ë“±ì˜ ì°¨ì´ì ì´ ìˆì–´ ì‹¤í–‰í™˜ê²½ì— ëŒ€í•œ ì„¤ì • ë¶„ë¦¬ê°€ í•„ìš”í–ˆë‹¤.
ëª¨ëª¨íŒ€ì€ Spring Profileì„ í†µí•´ ì‹¤í–‰í™˜ê²½ ì„¤ì •ì„ ì‰½ê²Œ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•˜ì˜€ìœ¼ë©° í•´ë‹¹ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Profileì„ ì ìš©í•˜ë©° í•™ìŠµí•œ ë‚´ìš©ì„ ì •ë¦¬í–ˆë‹¤.


# 1. í”„ë¡œíŒŒì¼(Profile)ì´ë€?

ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•˜ë‹¤ë³´ë©´ ì‹¤í–‰ í™˜ê²½ì— ë”°ë¼ êµ¬ì„± ëª…ì„¸ë¥¼ ë‹¤ë¥´ê²Œ ì„¤ì •í•´ì•¼í•  ë•Œê°€ ì¡´ì¬í•œë‹¤. ì˜ˆë¥¼ ë“¤ë©´ ë°°í¬ë¥¼ ìœ„í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•˜ë‹¤ë³´ë©´ ë¡œì»¬ì„œë²„, ê°œë°œì„œë²„, ë°°í¬ì„œë²„ ë“± ì‹¤í–‰ë˜ëŠ” ìœ„ì¹˜ì— ë”°ë¼ ì‹¤í–‰ í™˜ê²½ ì„¤ì •ì´ ë‹¬ë¼ì§€ê²Œ ëœë‹¤. í•„ìëŠ” ìµœê·¼ ì§„í–‰í•œ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë¡œì»¬ì˜ ê²½ìš° H2 DB ë˜ëŠ” ë¡œì»¬ PCì— ì„¤ì¹˜í•´ë‘” MySQL DBë¥¼ ì—°ê²°í•˜ì˜€ë‹¤. ê·¸ë¦¬ê³  ê°œë°œ ì„œë²„, ë°°í¬ ì„œë²„ì—ëŠ” ê°ê° ì‹¤í–‰í™˜ê²½ì—ì„œ ì‚¬ìš©ì¤‘ì¸ DBë¥¼ ì—°ê²°ì‹œí‚¨ í›„ì— ê°œë°œì„ ì§„í–‰í•˜ì˜€ë‹¤.

ì´ëŸ¬í•œ í™˜ê²½ì— ëŒ€í•œ ì„¤ì •ì€ OSì˜ í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•´ ì„¤ì •í•  ìˆ˜ë„ ìˆì§€ë§Œ ë³€ê²½ì ì´ ìˆì„ ë•Œë§ˆë‹¤ ì§ì ‘ í™˜ê²½ ë³€ìˆ˜ë¥¼ ë³€ê²½í•´ì¤˜ì•¼í•˜ê³ , ë°°í¬ ì„œë²„ì˜ ê²½ìš° ì—¬ëŸ¬ ì„œë²„ë¥¼ ì´ìš©í•  ê²½ìš° ì—¬ëŸ¬ê°œì˜ ì„œë²„ë¥¼ ë³€ê²½í•´ì¤˜ì•¼ í•˜ëŠ” ë“±ì˜ ë²ˆê±°ë¡œì›€ì´ ë™ë°˜í•˜ê²Œ ëœë‹¤. ê·¸ë¦¬ê³  í™˜ê²½ë³€ìˆ˜ ë³€ê²½ì€ Gitì„ í†µí•œ í˜•ìƒê´€ë¦¬ë„ í•  ìˆ˜ ì—†ë‹¤ëŠ” ë‹¨ì ë„ ì¡´ì¬í•œë‹¤. ê·¸ë˜ì„œ ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ë¥¼ ê°œë°œí•  ë•ŒëŠ” í™˜ê²½ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸°ë³´ë‹¤ ìŠ¤í”„ë§ì˜ í”„ë¡œíŒŒì¼(Profile)ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

Springì€ ì‹¤í–‰ í™˜ê²½ì— ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„¤ì •ì„ ë‹¤ë¥´ê²Œ í•´ì£¼ëŠ” í”„ë¡œíŒŒì¼ì´ë¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ê³  ìˆë‹¤. í”„ë¡œíŒŒì¼ì„ ì‚¬ìš©í•˜ë©´ ëŸ°íƒ€ì„ì‹œì— í™œì„±í™”ë˜ëŠ” í”„ë¡œíŒŒì¼ì— ë”°ë¼ ì„œë¡œ ë‹¤ë¥¸ ë¹ˆ, êµ¬ì„± í´ë˜ìŠ¤, êµ¬ì„± ì†ì„± ë“¤ì´ ì ìš© ë˜ëŠ” ë¬´ì‹œë  ìˆ˜ë¡ í•  ìˆ˜ ìˆë‹¤. ì•ì„œ ì˜ˆì‹œë¡œ ë“  ë¡œì»¬ï¹’ê°œë°œï¹’ë°°í¬ì„œë²„ì˜ ì„¤ì •ì˜ ê²½ìš°, ê°œë°œ í”„ë¡œíŒŒì¼ì„ í™œì„±í™”ì‹œí‚¤ë©´ ê°œë°œ ì„œë²„ì—ì„œ ì‚¬ìš©í•˜ëŠ” DBë¥¼ ì—°ê²°í•˜ê²Œë˜ê³  ë°°í¬ í”„ë¡œíŒŒì¼ì„ í™œì„±í™”ì‹œí‚¤ë©´ ë°°í¬ ì„œë²„ì˜ DBë¥¼ ì—°ê²°í•˜ëŠ” ë“± ê°„í¸í•˜ê²Œ í™˜ê²½ ì„¤ì •ì„ í•  ìˆ˜ ìˆë‹¤.

# 2. Profile ì†ì„± ì •ì˜í•˜ê¸°

í”„ë¡œíŒŒì¼ì— íŠ¹ì •í•œ ì†ì„±ì„ ì •ì˜í•˜ë ¤ë©´ ê°ê°ì˜ í™˜ê²½ì˜ ì†ì„±ë“¤ë§Œì„ í¬í•¨í•˜ëŠ” ë³„ë„ì˜ `.yml`, `.properties` íŒŒì¼ì„ ë§Œë“¤ì–´ì•¼ í•œë‹¤. ì´ë•Œ íŒŒì¼ì˜ ì´ë¦„ì€ `application-{í”„ë¡œíŒŒì¼ ì´ë¦„}.yml`, `application-{í”„ë¡œíŒŒì¼ ì´ë¦„}.properties` ì˜ í˜•ì‹ìœ¼ë¡œ ìƒì„±ì„ í•˜ì—¬ì•¼ í•œë‹¤.

í•„ìëŠ” ë¡œì»¬, ê°œë°œ, ë°°í¬ í™˜ê²½ì— ë§ëŠ” 3ê°œì˜ ymlíŒŒì¼ì„ ë§Œë“¤ì–´ë³´ì•˜ë‹¤.

- `application-local.yml`

    ```yaml
    spring:
      datasource:
        username: sa
        url: jdbc:h2:~/momo;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
      jpa:
        properties:
          hibernate.dialect: org.hibernate.dialect.H2Dialect
        hibernate.ddl-auto: create-drop
        database-platform: org.hibernate.dialect.H2Dialect
    ```

- `application-dev.yml`

    ```yaml
    spring:
      datasource:
        driver-class-name: com.mysql.cj.jdbc.Driver
        username: momo
        password: momo123!
        url: jdbc:mysql://{ê°œë°œì„œë²„DB_IP}:3306/momo?serverTimezone=UTC&characterEncoding=UTF-8
      jpa:
        hibernate.ddl-auto: validate
        database-platform: org.hibernate.dialect.MySQL8Dialect
    ```

- `application-prod.yml`

    ```yaml
    spring:
      datasource:
        driver-class-name: com.mysql.cj.jdbc.Driver
        username: momo
        password: momo123!
        url: jdbc:mysql://{ë°°í¬ì„œë²„DB_IP}:3306/momo?serverTimezone=UTC&characterEncoding=UTF-8
      jpa:
        hibernate.ddl-auto: validate
        database-platform: org.hibernate.dialect.MySQL8Dialect
    ```


> ê³¼ê±°ì—ëŠ” í•˜ë‚˜ì˜ yml íŒŒì¼ ë‚´ì—ì„œ 3ê°œì˜ í•˜ì´í”ˆ(`---`)ì„ ê¸°ì¤€ìœ¼ë¡œ profileì„ ë¶„ë¦¬í•  ìˆ˜ ìˆì—ˆë‹¤. í•˜ì§€ë§Œ Spring Boot 2.4ë²„ì „ë¶€í„° í•´ë‹¹ ê¸°ëŠ¥ì€ deprecatedë˜ì–´ ì´ì œëŠ” ê°œë³„ë¡œ í”„ë¡œíŒŒì¼ `yml`íŒŒì¼ì„ ìƒì„±í•´ì¤˜ì•¼ í•œë‹¤.
>
>
> ![Untitled](image/20220821_ìŠ¤í”„ë§-Profileì´ë€/img.png)
>
> - [[spring-boot] 2.4 ë¶€í„° ë³€ê²½ëœ êµ¬ì„±íŒŒì¼ ì²˜ë¦¬ë°©ì‹ ì‚´í´ë³´ê¸°](http://honeymon.io/tech/2021/01/16/spring-boot-config-data-migration.html)
>

# 3. Profile í™œì„±í™”í•˜ê¸°

ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ìš°ì„  ê¸°ë³¸ì ìœ¼ë¡œ `application.yml`Â íŒŒì¼ ë‚´ ëª¨ë“  property ë¥¼ ë¡œë“œí•œ í›„ì— í™œì„±í™”(active)ëœ profile ë“¤ì— ëŒ€í•œ `.yml` íŒŒì¼ì— ëŒ€í•´ì„œë§Œ property ë¥¼ ë¡œë“œí•œë‹¤. í™œì„±í™”ì‹œí‚¬ í”„ë¡œíŒŒì¼ì€ 1ê°œ ì´ìƒì¼ ìˆ˜ê°€ ìˆìœ¼ë©° í™œì„±í™”ì‹œí‚¤ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ë°©ë²•ì´ ì¡´ì¬í•œë‹¤.

ì§€ê¸ˆë¶€í„° í”„ë¡œíŒŒì¼ì„ activeí•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì‚´í´ë³´ê² ë‹¤.

## 3.1. application.ymlì„ í†µí•œ í™œì„±í™”

ê¸°ë³¸ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” `application.yml` íŒŒì¼ì— `spring.profiles.active` ì†ì„±ì„ í†µí•´ ì‹¤í–‰ë˜ëŠ” í”„ë¡œíŒŒì¼ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ í•´ë‹¹ ë°©ë²•ì€ í™œì„±í™”ì‹œí‚¬ ê¸°ë³¸ í”„ë¡œíŒŒì¼ì„ ymlì„ í†µí•´ ì„¤ì •í•˜ëŠ” ê²ƒì´ë¼ ê°œë°œ í™˜ê²½ì— ë”°ë¼ ì‹¤í–‰ë˜ëŠ” í”„ë¡œíŒŒì¼ì„ ì‰½ê²Œ ì„¤ì •í•˜ëŠ” í”„ë¡œíŒŒì¼ì˜ ì´ì ì„ ì‚´ë¦´ ìˆ˜ê°€ ì—†ë‹¤. ë•Œë¬¸ì— í•´ë‹¹ ë°©ë²•ì€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ë‹¤.

```yaml
spring:
  profiles:
    active:
      - prod
```

## 3.2. í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•œ í™œì„±í™”

í”„ë¡œë•ì…˜ í™˜ê²½ì˜ `SPRING_PROFILES_ACTIVE`í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ë©° í™œì„±í™”ì‹œí‚¬ í”„ë¡œíŒŒì¼ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

```bash
% export SPRING_PROFILES_ACTIVE=prod
```

í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•´ í”„ë¡œíŒŒì¼ì„ í™œì„±í™”ì‚¬í‚¤ë©´ `application.yml`ì—ì„œ `spring.profiles.active` ì†ì„±ì„ í†µí•´ ì„¤ì •í•œ ê¸°ë³¸ í”„ë¡œíŒŒì¼ì˜ ë™ì¼í•œ ì†ì„±ë³´ë‹¤ ë” ë†’ì€ ìš°ì„ ìˆœìœ„ë¥¼ ê°–ê²Œë˜ì–´ í•´ë‹¹ í”„ë¡œíŒŒì¼ì´ ì‹¤í–‰ë˜ê²Œ ëœë‹¤.

## 3.3. Jar íŒŒì¼ ì‹¤í–‰ ì„¤ì •ì„ í†µí•œ í™œì„±í™”

JARíŒŒì¼ì„ í†µí•´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ë©° í”„ë¡œíŒŒì¼ ì„¤ì •ì„ í•œë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ `--spring.profiles.active` ì˜µì…˜ì„ í†µí•´ ì„¤ì •í•´ì£¼ë©´ ëœë‹¤.

```bash
java -jar {íŒŒì¼ëª…}.jar --spring.profiles.active=prod
```

## 3.4. IntelliJ ì„¤ì •

1. Run > Edit Configurations... ì„ íƒ
2. Spring Boot Application ì„ íƒ
3. Active profiles ì—ì„œ ì›í•˜ëŠ” profile ëª…ì„ ì…ë ¥ í›„ ì‹¤í–‰

![Untitled](image/20220821_ìŠ¤í”„ë§-Profileì´ë€/img_1.png)

# ğŸ“š Reference
- [ìŠ¤í”„ë§ ì¸ ì•¡ì…˜ : ë„¤ì´ë²„ ë„ì„œ](https://search.shopping.naver.com/book/catalog/32441616013?cat_id=50010920&frm=PBOKPRO&query=%EC%8A%A4%ED%94%84%EB%A7%81%EC%9D%B8%EC%95%A1%EC%85%98&NaPm=ct%3Dl73e8ti0%7Cci%3Dfd13b06857fe558f4b9beb699e164f5a995fb85d%7Ctr%3Dboknx%7Csn%3D95694%7Chk%3D700b39cf6841823d167206c12bb45d010f14b68f)
- [Springboot Profile ì„¤ì •ë°©ë²• ë° ê°€ì ¸ì˜¤ê¸°](https://oingdaddy.tistory.com/393)
- [Spring Profiles | Baeldung](https://www.baeldung.com/spring-profiles)
- [Spring Boot - Profileì— ë”°ë¥¸ properties(yml) íŒŒì¼ ì„¤ì •í•˜ê¸°](https://galid1.tistory.com/664)
- [[spring-boot] 2.4 ë¶€í„° ë³€ê²½ëœ êµ¬ì„±íŒŒì¼ ì²˜ë¦¬ë°©ì‹ ì‚´í´ë³´ê¸°](http://honeymon.io/tech/2021/01/16/spring-boot-config-data-migration.html)
